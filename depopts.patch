diff --git a/coq-graph-theory.opam b/coq-graph-theory.opam
index 2a9ea1d..8487df7 100644
--- a/coq-graph-theory.opam
+++ b/coq-graph-theory.opam
@@ -20,15 +20,18 @@ from the study of relation algebra within the ERC CoVeCe project
 (e.g., soundness and completeness of an axiomatization of graph
 isomorphism)."""
 
-build: [make "-j%{jobs}%" ]
+build: [
+  ["sh" "-exc" "cat _CoqProject.wagner >>_CoqProject"] {coq-fourcolor:installed}
+  [make "-j%{jobs}%" ]
+]
 install: [make "install"]
 depends: [
   "coq" {(>= "8.12" & < "8.14~") | (= "dev")}
   "coq-mathcomp-algebra" {(>= "1.12" & < "1.13~") | (= "dev")}
   "coq-mathcomp-finmap" 
   "coq-hierarchy-builder" { (>= "1.1.0") }
-  "coq-fourcolor" 
 ]
+depopts: ["coq-fourcolor"]
 
 tags: [
   "category:Computer Science/Graph Theory"
diff --git b/.github/workflows/docker-action.yml a/.github/workflows/docker-action.yml
index 1898673..30ff64d 100644
--- b/.github/workflows/docker-action.yml
+++ a/.github/workflows/docker-action.yml
@@ -1,5 +1,3 @@
-# This file was generated from `meta.yml`, please do not edit manually.
-# Follow the instructions on https://github.com/coq-community/templates to regenerate.
 name: Docker CI
 
 on:
@@ -29,6 +27,15 @@ jobs:
         with:
           opam_file: 'coq-graph-theory.opam'
           custom_image: ${{ matrix.image }}
+          # we manually install the optional dependency coq-fourcolor
+          install: |
+            startGroup "Install dependencies"
+              opam pin add -n -y -k path $PACKAGE $WORKDIR
+              opam update -y
+              opam install -y -j 2 $PACKAGE --deps-only
+              opam install -y -j 2 coq-fourcolor
+            endGroup
+
 
 # See also:
 # https://github.com/coq-community/docker-coq-action#readme
